{% extends "ajaxformbase2.html" %}
{% block extraheading %}
    <style type="text/css">
        tr.lista_reactivos td{
            border: none;
        }
        tr.lista_reactivos:hover {
            background-color: #B5FAAF;
            border-style: outset;
            border-width: 2px;
        }
        tr.lista_reactivos:hover a h5{
            color: green;
        }
        tr.lista_reactivos:hover a{
            color: white;
            font-size: small;
        }
        .labeltable{
            margin-left: 10px;
            display: inline;
        }
        .checkboxtable {
            margin: 0 0 0 !important;
        }
        .trtable{
            border: hidden;
        }
    </style>
    <script type="text/javascript">
        $(function () {
            var opcionmax={{ asignacion.formato.formatoreactivo.opcionesmax }};
            var opcionmin={{ asignacion.formato.formatoreactivo.opcionesmin }};
            var respmin={{ asignacion.formato.formatoreactivo.respuestasmin }};
            var respmax={{ asignacion.formato.formatoreactivo.respuestasmax }};
            var tipopregunta = "";
            $('#formbutton').addClass('hidden');
            lista_items1 = []; //para los atributos
            lista_items2 = []; //para las opciones
            alertadetalle = function (t) {
                smoke.alert("Mensaje: "+$(t).attr('mensaje'));
            };
            limpiar = function(){
                switch (tipopregunta) {
                    case "vf":
                        $('.checkbox_vf ').removeAttr('checked');
                        $('.valorvf').val('');
                        $('.valorvf').attr('disabled', 'disabled');
                        break;
                    case "om":
                        $('.checkbox_om').removeAttr('checked');
                        $('.valorp').val('');
                        $('.valorp').attr('disabled', 'disabled');
                        $('.opciontexto').val('');
                        var index = 1;
                        $('.trom').each(function () {
                             if(index <= opcionmin){
                                 $(this).removeAttr('style');
                             }else{
                                 $(this).css('display','none');
                                 $(this).attr('vali','no');
                             }
                             resetinput('file_om'+index);
                             index++;
                        });
                        break;
                    case "em":
                        $('.checkbox_em').removeAttr('checked');
                        $('.opciontextoa').val('');
                        $('.opciontextob').val('');
                        var index = 1;
                        $('.trem').each(function () {
                             if(index <= opcionmin){
                                 $(this).removeAttr('style');
                             }else{
                                 $(this).css('display','none');
                                 $(this).attr('vali','no');
                             }
                             index++;
                        });
                        break;
                };
            };
            $('#selecttipo').on('change', function () {
                $('#tbodyopciones').html('');
                tipopregunta = $(this).val();
                if(tipopregunta!= ""){
                    if(tipopregunta == "vf"){
                        $('#tbverdaderofalso').removeAttr('style');
                        $('#tbopcionmultiple').css('display', 'none');
                        $('#tbemparejamiento').css('display', 'none');
                        lista_items2 = [{action:"add", id:1, texto:"verdadero", imagen:"", valor:0, vali:false},{action:"add", id:2, texto:"falso", imagen:"", valor:0, vali:false}];
                    }else if(tipopregunta == "em"){
                        $('#tbverdaderofalso').css('display', 'none');
                        $('#tbopcionmultiple').css('display', 'none');
                        $('#tbemparejamiento').removeAttr('style');
                        lista_items2 = [];
                    }else if(tipopregunta == "om"){
                        $('#tbverdaderofalso').css('display', 'none');
                        $('#tbemparejamiento').css('display', 'none');
                        $('#tbopcionmultiple').removeAttr('style');
                        lista_items2 = [];
                    }
                }else{
                    tipopregunta = "";
                    $('#tbverdaderofalso').css('display', 'none');
                }
                vali();
                limpiar();
            });
            cargar = function () {
                lista_items1 = [];
                var item = {};
                {% for atributo in atributos %}
                    item = {idatributo: {{ atributo.id }}, atributo: "{{ atributo.nombre }}", texto:"", imagen:"", action:"add"};
                    if(lista_items1.length == 0){
                        lista_items1 = [item];
                    }else{
                        lista_items1.push(item);
                    }
                {% endfor %}
            };
            window.onloadend = cargar();
            $('.fileatributo').on('change', function () {
                var idatributo = $(this).attr('idatributo');
                var name = $(this).attr('name');
                var file = $(this).prop("files")[0];
                if(file == undefined)
                    name=null;
                for(i=0; i<lista_items1.length; i++){
                    if(lista_items1[i].idatributo == idatributo){
                        if(name != null) lista_items1[i].imagen = name;
                        else lista_items1[i].imagen = "";
                        break;
                    }
                }

                validetalle();
            });
            $('.detallereactivo').on('change', function () {
                var idatributo = $(this).attr('idatributo');
                var texto = $(this).val().replace(/\n/g," ").trim();
                texto = texto.replace(/\s+/gi,' ');
                $(this).val(texto);
                for(i=0; i<lista_items1.length; i++){
                    if(lista_items1[i].idatributo == idatributo){
                        lista_items1[i].texto = texto;
                    }
                }

                validetalle();
            });
            validetalle = function(){
                var ban = true;
                for(i=0; i<lista_items1.length; i++){
                    if(lista_items1[i].texto == ""){
                        ban = false;
                        break;
                    }
                }
                if(ban) $('#validetalles').val('1');
                else $('#validetalles').val('0');
                return ban;
            };
            valivf = function(){
                var ban = false;
                for(i=0; i<lista_items2.length; i++){
                    if(lista_items2[i].vali == true){
                        ban = true;
                        break;
                    }
                }
                return ban;
            };
            valiom = function(){
                var ban = true;
                for(i=0; i<lista_items2.length; i++){
                    if(lista_items2[i].action == "add" && lista_items2[i].texto == "" && lista_items2[i].imagen == "" || (lista_items2[i].vali == true && lista_items2[i].valor == 0)){
                        ban = false;
                        break;
                    }
                }
                if(ban){
                    var count = 0;
                    var count2 = 0;
                    for(i=0; i<lista_items2.length; i++){
                        if(lista_items2[i].vali == true){
                            count = count + lista_items2[i].valor;
                            count2++;
                        }
                    }
                    if(count == 100 && count2 >= respmin && count2 <= respmax && lista_items2.length >= opcionmin && lista_items2.length <= opcionmax){
                        ban = true;
                    }else{
                        ban = false;
                    }
                }
                return ban;
            };
            valiem = function(){
                var ban = true;
                for(i=0; i<lista_items2.length; i++){
                    if(lista_items2[i].textoa == "" || lista_items2[i].textob == "" || (lista_items2[i].vali == true && lista_items2[i].valor == 0)){
                        ban = false;
                        break;
                    }
                }
                if(ban){
                    var count = 0;
                    var count2 = 0;
                    for(i=0; i<lista_items2.length; i++){
                        if(lista_items2[i].vali == true){
                            count = count + lista_items2[i].valor;
                            count2++;
                        }
                    }
                    if(count == 100 && lista_items2.length >= opcionmin && lista_items2.length <= opcionmax){
                        ban = true;
                    }else{
                        ban = false;
                    }
                }
                return ban;
            };
            valiaddom = function(id){
                var ban = true; //no existe
                if(tipopregunta == "om"){
                    for(i=0; i<lista_items2.length; i++){
                        if(lista_items2[i].id == id){
                            ban = false; //existe
                            break;
                        }
                    }
                }
                return ban;
            };
            valiaddem = function(id){
                var ban = true; //no existe
                if(tipopregunta == "em"){
                    for(i=0; i<lista_items2.length; i++){
                        if(lista_items2[i].id == id){
                            ban = false; //existe
                            break;
                        }
                    }
                }
                return ban;
            };
            vali = function(){
                switch (tipopregunta) {
                    case "vf":
                        if(valivf()){
                            $('#valiopciones').val('1');
                        }else{
                            $('#valiopciones').val('0');
                        }
                        break;
                    case "om":
                        if(valiom()){
                            $('#valiopciones').val('1');
                        }else{
                            $('#valiopciones').val('0');
                        }
                        break;
                    case "em":
                        if(valiem()){
                            $('#valiopciones').val('1');
                        }else{
                            $('#valiopciones').val('0');
                        }
                        break;
                };
            };
            checkom = function(value, id){
                for(i=0; i<lista_items2.length; i++){
                    if(lista_items2[i].imagen != "" || lista_items2[i].texto!= ""){
                        if(lista_items2[i].id==id){
                            lista_items2[i].vali = value;
                            if(value == false){
                                lista_items2[i].valor = 0;
                                $('#vp_om'+id).val('');
                                $('#vp_om'+id).attr('disabled', 'disabled');
                            }
                            else{
                                $('#vp_om'+id).removeAttr('disabled');
                                $('#vp_om'+id).val('100');
                                lista_items2[i].valor = 100;
                            }
                        }
                    }
                }
            };
            checkem = function(value, id){
                for(i=0; i<lista_items2.length; i++){
                    if(lista_items2[i].id == id){
                        lista_items2[i].vali = value;
                        if(value == false){
                            lista_items2[i].valor = 0;
                            $('#vp_em'+id).val('');
                            $('#vp_em'+id).attr('disabled', 'disabled');
                        }else{
                            $('#vp_em'+id).removeAttr('disabled');
                        }
                    }
                }
            };
            checkvf = function(valor, value){
                if(valor=="verdadero"){
                    if(value == true){
                        lista_items2[0].vali = true;
                        lista_items2[0].valor = 100;
                        lista_items2[1].vali = false;
                        lista_items2[1].valor = 0;
                        $('#checkbox_falso').removeAttr('checked');
                        $('#vp_falso').val('');
                        $('#vp_verdadero').val(lista_items2[0].valor);
                    }else{
                        lista_items2[0].vali = false;
                        lista_items2[0].valor = 0;
                        $('#vp_verdadero').val('');
                    }
                }else{
                    if(value == true){
                        lista_items2[1].vali = true;
                        lista_items2[1].valor = 100;
                        lista_items2[0].vali = false;
                        lista_items2[0].valor = 0;
                        $('#checkbox_verdadero').removeAttr('checked');
                        $('#vp_verdadero').val('');
                        $('#vp_falso').val(lista_items2[1].valor);
                    }else{
                        lista_items2[1].vali = false;
                        lista_items2[1].valor = 0;
                        $('#vp_falso').val('');
                    }
                }
            };
            $('.checkboxtable').on('change', function () {
                switch (tipopregunta) {
                    case "vf":
                        var checked = $(this).attr('checked');
                        var valor = $(this).attr('valor');
                        if(checked == 'checked') checked = true;
                        else checked = false;
                        checkvf(valor, checked);
                        break;
                    case "om":
                        var checked = $(this).attr('checked');
                        var id = $(this).attr('idtr');
                        if(checked == 'checked') checked = true;
                        else checked = false;
                        var files = $('#file_om'+id).prop("files")[0];
                        if($('#input_om'+id).val()!= "" || files != undefined){
                            checkom(checked, id);
                        }else{
                            $(this).removeAttr('checked');
                        }
                        break;
                    case "em":
                        var checked = $(this).attr('checked');
                        var id = $(this).attr('idtr');
                        if(checked == 'checked') checked = true;
                        else checked = false;
                        if($('#input_ema'+id).val()!= "" || $('#input_emb'+id).val()!= ""){
                            checkem(checked, id);
                        }else{
                            $(this).removeAttr('checked');
                        }
                        break;
                };
                vali();
            });
            $('.add_filaem').click(function () {
                var count = 0;
                var index = 0;
                $('#tbodyemparejamiento tr').each(function () {
                   var vali = $(this).attr('vali');
                   var idtr = $(this).attr('idtr');
                   index++;
                   if(vali != "si" && count != 1){
                       $(this).removeAttr('style');
                       $(this).attr('vali','si');
                       $('#label_em'+idtr).text(index);
                       count=1;
                   }
                });
            });
            $('.add_filaom').click(function () {
                var count = 0;
                var index=0;
                $('#tbodyopcionmultiple tr').each(function () {
                   var vali = $(this).attr('vali');
                   var idtr = $(this).attr('idtr');
                   index++;
                   if(vali != "si" && count != 1){
                       $(this).removeAttr('style');
                       $(this).attr('vali','si');
                       $('#label_om'+idtr).text(index);
                       count=1;
                   }
                });
            });
            $('.opciontexto').on('change', function () {
                if(tipopregunta =="om"){
                    var id=$(this).attr('idtr');
                    var texto = $(this).val().replace(/\n/g," ").trim();
                    texto = texto.replace(/\s+/gi,' ');
                    $(this).val(texto);
                    var item = {action:'add', id:id, texto:texto, imagen:'', valor:0, vali:false};
                    if(lista_items2.length == 0){
                        lista_items2 = [item]
                    }else{
                        if(valiaddom(id)){
                            lista_items2.push(item);
                        }else{
                            for(i=0; i<lista_items2.length; i++){
                                if(lista_items2[i].id==id){
                                    lista_items2[i].texto = texto;
                                }
                            }
                        }
                    }
                }
                vali();
            });
            $('.fileom').on('change', function () {
                if(tipopregunta == "om") {
                    var id = $(this).attr('idtr');
                    var name = $(this).attr('name');
                    var file = $(this).prop("files")[0];
                    if (file == undefined) {
                        name = "";
                    }
                    var item = {action: 'add', id: id, texto: '', imagen: name, valor: 0, vali: false};
                    if (lista_items2.length == 0) {
                        lista_items2 = [item];
                    } else {
                        if (valiaddom(id)) {
                            lista_items2.push(item);
                        } else {
                            for (i = 0; i < lista_items2.length; i++) {
                                if (lista_items2[i].id == id) {
                                    lista_items2[i].imagen = name;
                                }
                            }
                        }
                    }
                }
                vali();
            });
            $('.valorp').on('change', function () {
                if(tipopregunta == "om"){
                    var id = $(this).attr('idtr');
                    var valor = $(this).val();
                    for(i=0; i<lista_items2.length; i++){
                        if(lista_items2[i].id == id && lista_items2[i].action == "add" && (lista_items2[i].texto != "" || lista_items2[i].imagen != "") && lista_items2[i].vali == true){
                            lista_items2[i].valor = parseInt(valor);
                        }
                    }
                }
                vali();
            });
            resetinput = function(input){
                $('#'+input).val('');
                //recorrer label para desactivar el span de seleccionado
                var label = "";
                $('.badge').each(function () {
                    var padre = $(this).parent();
                    var id = $(padre).attr('for');
                    if(id==input){
                        label = $(this);
                    }
                });
                $(label).remove();
            };
            eliminar = function (t) {
                var id = $(t).attr('idtr');
                if(tipopregunta == "om"){
                    $('#trom_'+id).prop('style', 'display:none');
                    $('#trom_'+id).attr('vali', 'no');
                    for(i=0; i<lista_items2.length; i++){
                        if(lista_items2[i].id == id){
                            lista_items2.splice(i,1);
                        }
                    }
                    //borrar datos
                    $('#checkbox_om'+id).removeAttr('checked');
                    $('#vp_om'+id).val('');
                    $('#vp_om'+id).attr('disabled','disabled');
                    $('#input_om'+id).val('');
                    resetinput('file_om'+id);
                    //cambiar fila
                    var row = $('#trom_'+id);
                    var index = 0;
                    $('#tbodyopcionmultiple tr').each(function () {
                        var actual = $(this);
                        index++;
                        if(index == opcionmax && ($(row).attr('idtr') != $(actual).attr('idtr'))){
                            row.insertAfter(actual);
                        }
                    });
                    //actualizar numeros
                    var count = 1;
                    $('#tbodyopcionmultiple tr').each(function () {
                        var vali= $(this).attr('vali');
                        var idtr = $(this).attr('idtr');
                        if(vali == "si"){
                            $('#label_om'+idtr).text(count);
                            count++;
                        }
                    });
                }else{
                    if(tipopregunta == "em"){
                        $('#trem_'+id).prop('style', 'display:none');
                        $('#trem_'+id).attr('vali', 'no');
                        for(i=0; i<lista_items2.length; i++){
                            if(lista_items2[i].id == id){
                                lista_items2.splice(i,1);
                            }
                        }
                        //borrar datos
                        $('#checkbox_em'+id).removeAttr('checked');
                        $('#input_ema'+id).val('');
                        $('#input_emb'+id).val('');
                        $('#vp_em'+id).val('');
                        $('#vp_em'+id).attr('disabled', 'disabled');
                        //cambiar fila
                        var row = $('#trem_'+id);
                        var index = 0;
                        $('#tbodyemparejamiento tr').each(function () {
                            var actual = $(this);
                            index++;
                            if(index == opcionmax && ($(row).attr('idtr') != $(actual).attr('idtr'))){
                                row.insertAfter(actual);
                            }
                        });
                        //actualizar numeros
                        var count = 1;
                        $('#tbodyemparejamiento tr').each(function () {
                            var vali= $(this).attr('vali');
                            var idtr = $(this).attr('idtr');
                            if(vali == "si"){
                                $('#label_em'+idtr).text(count);
                                count++;
                            }
                        });
                    }
                }
                vali();
            };
            $('.opciontextoa').on('change', function () {
               if(tipopregunta == "em"){
                    var id=$(this).attr('idtr');
                    var texto = $(this).val().replace(/\n/g," ").trim();
                    texto = texto.replace(/\s+/gi,' ');
                    $(this).val(texto);
                    var item = {action:'add', id:id, textoa:texto, textob:'', texto:'', imagen:'', valor:0, vali:true};
                    if(lista_items2.length == 0){
                        lista_items2 = [item];
                    }else{
                        if(valiaddem(id)){
                            lista_items2.push(item);
                        }else{
                            for(i=0; i<lista_items2.length; i++){
                                if(lista_items2[i].id==id && lista_items2[i].action != "del"){
                                    lista_items2[i].textoa = texto;
                                    lista_items2[i].texto = lista_items2[i].textoa + ";" +lista_items2[i].textob;
                                }
                            }
                        }
                    }
               }
                vali();
            });
            $('.opciontextob').on('change', function () {
               if(tipopregunta == "em"){
                    var id=$(this).attr('idtr');
                    var texto = $(this).val().replace(/\n/g," ").trim();
                    texto = texto.replace(/\s+/gi,' ');
                    $(this).val(texto);
                    var item = {action:'add', id:id, textoa:'', textob:texto, texto:'', imagen:'', valor:0, vali:true};
                    if(lista_items2.length == 0){
                        lista_items2 = [item];
                    }else{
                        if(valiaddem(id)){
                            lista_items2.push(item);
                        }else{
                            for(i=0; i<lista_items2.length; i++){
                                if(lista_items2[i].id==id && lista_items2[i].action != "del"){
                                    lista_items2[i].textob = texto;
                                    lista_items2[i].texto = lista_items2[i].textoa + ";" +lista_items2[i].textob;
                                }
                            }
                        }
                    }
               }
                vali();
            });
            $('.valorem').on('change', function () {
                var id = $(this).attr('idtr');
                var tipoa = $('#input_ema'+id).val();
                var tipob = $('#input_emb'+id).val();
               if(tipopregunta == "em"){
                   if(tipoa != "" && tipob != ""){
                       var valor = $(this).val();
                       for(i=0; i<lista_items2.length; i++){
                            if(lista_items2[i].id == id && lista_items2[i].action != "del" && (lista_items2[i].textoa != "" || lista_items2[i].textob != "") && lista_items2[i].vali == true){
                                lista_items2[i].valor = parseInt(valor);
                            }
                        }
                   }else{
                       $(this).val('');
                   }
                   vali();
               }
            });
            similitud = function () {
                var texto = "";
                var ban1 = validetalle();
                $('.detallereactivo').each(function () {
                    texto = texto + " " + $(this).val();
                    ban1=true;
                });
                var ban2=false;
                if(tipopregunta != "vf"){
                    if(tipopregunta == "om"){
                        ban2= valiom();
                        $('.opciontexto').each(function () {
                            texto = texto + " " + $(this).val();
                        });
                    }else{
                        var index = 0;
                        ban2 = valiem();
                        $('.opciontextoa').each(function () {
                            texto2 = $('.opciontextob')[index];
                            texto = texto + " " + $(this).val() + " "+$(texto2).val();
                            index++;
                        });

                    }
                }
                if(ban1 && ban2){

                $.ajax({
                    type: "POST",
                    url: "/doc_configuracioncomplexivo",
                    {% if asignacion.asignatura %}data: {'action': 'add_similitud','idasignaturamalla': {{asignacion.asignatura.id}}, 'texto': texto, 'porcentaje':'{{porcentaje|floatformat:0}}'},
                    {% else %}data: {'action': 'add_similitud','idarea': {{asignacion.area.id}}, 'texto': texto, 'porcentaje':'{{porcentaje|floatformat:0}}'},{% endif %}
                    success: function(data) {
                        if (data.result == 'ok') {
                            smoke.alert('Validado correctamente');
                            $('#formbutton').removeClass('hidden');
                        } else {
                            $('#formbutton').addClass('hidden');
                            smoke.alert(data.mensaje);
                            atributos = data.reactivo['atributos'];
                            opciones = data.reactivo['opciones'];
                            $('#divresult').html('<div style="text-align:center; color:red">'+data.mensaje+'</div>');
                            for(detalle in atributos){
                                $('#divresult').append('<label><b>'+atributos[detalle]['atributo__nombre']+':</b> '+atributos[detalle]['texto']+'</label>');
                            }
                            for(detalle in opciones){
                                $('#divresult').append('<label><b>'+(parseInt(detalle)+1)+':</b> '+opciones[detalle]['texto']+'</label>');
                            }
                        }
                    },
                    error: function() {
                        $.unblockUI();
                        smoke.alert(data.mensaje);
                    },
                    dataType: "json"
                });
                }
            };
        });
    </script>

{% endblock %}
{% block titulo %}
    <h5>{{ title }}</h5>
    {% if asignacion.formato.formatoreactivo.tiporeactivo.nombre == "GENERAL" %}
        <h5>ÁREA: {{ asignacion.area.nombre }}</h5>
    {% else %}
        <h5>ASIGNATURA: {{ asignacion.asignatura.asignatura.nombre }}</h5>
    {% endif %}
{% endblock %}
{% block formaction %}/doc_configuracioncomplexivo{% endblock %}
{% block formdestination %}/doc_configuracioncomplexivo?action=add_reactivodocente&id={{asignacion.id}}{% endblock %}
{% block formextra %}
    {% if reactivos|length >= asignacion.cantidad %}
    <div class="row-fluid" style="padding-bottom: 0px;">
        <div class="alert alert-success alert-dismissable">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <strong>¡Bien hecho!</strong> Haz completado la cantidad mínima de reactivos.
        </div>
    </div>
    {% endif %}
    <div class="row-fluid">
        <table width="100%" class="table table-bordered" >
            <thead>
                <tr>
                    <th style="text-align: center; padding-bottom: 20px;"><h5 style="padding-top: 10px">Reactivos agregados ({{ reactivos|length }} de {{asignacion.cantidad}})</h5></th>
                    <th style="text-align: center; padding-bottom: 20px;"><h5 style="padding-top: 10px">Reactivo - Nota máxima ({{ asignacion.formato.formatoreactivo.notamax }}) puntos</h5></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="width: 25%; text-align: center">
                        <div id="reactivosadd" class="tree well" style="overflow-y: auto;height: 450px; padding-top: 5px; padding-left: 5px; padding-right: 5px; padding-bottom: 5px;">
                            <table class="table table-hover">
                                <tbody style="text-align: center; border: hidden;">
                                    {% for reactivo in reactivos %}
                                        <tr style="text-align: center; width: 100%;" class="btn btn-lg btn-block lista_reactivos ">
                                            <td style="border-right: hidden;padding-left: 10px">
                                                <h5 >Reactivo {{ forloop.counter }} </h5>
                                                {% if reactivo.estadofinal == False %}<span class="label label-danger">Estado: Corregir</span>{% endif %}
                                            </td>
                                            <td style="width: 15%; text-align: center">
                                                <a title="Editar" href="/doc_configuracioncomplexivo?action=edit_reactivodocente&id={{ reactivo.id }}" class="btn btn-mini btn-warning"> <i class="fa fa-edit"></i></a>
                                                <a title="Eliminar" href="javascript:;" nhref="/doc_configuracioncomplexivo?action=del_reactivodocente&id={{ reactivo.id }}" class="btn btn-mini btn-danger eliminacionmodal"> <i class="fa fa-remove"></i></a>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </td>
                    <td>
                        <div class="well" style="padding-bottom: 0px;">
                            <div class="row-fluid">
                                <div class="span12">
                                    {% include 'doc_examencomplexivo/adm_detalleatributos.html' with atributos=atributos %}
                                    <div class="control-group cont-50" style="padding: 1%; min-height:45px; float: left;">
                                        <div class="control-label" style="width: 200px; text-align: right; line-height: 20px; padding-right: 10px;padding-top: 5px; float: left; text-transform: capitalize">
                                            <h5>Tipo de pregunta:</h5>
                                        </div>
                                        <div class="controls cont-div-50">
                                            <select class="mdb-select validate[required]" name="tipopregunta" id="selecttipo" formwidth="100">
                                                <option value="" disabled selected>Seleccionar....</option>
                                                {% for tipo in tipopreguntas %}
                                                  <option value="{{ tipo.abreviatura  }}">{{ tipo.nombre }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="control-group cont-50" style="padding: 1%; min-height:45px; float: left;">
                                        <div class="control-label" style="width: 200px; text-align: right; line-height: 20px; padding-right: 10px;padding-top: 5px; float: left; text-transform: capitalize">
                                            <h5>Calificación:</h5>
                                        </div>
                                        <div class="controls cont-div-35">
                                            <input type="number" id="calif" min="{{ asignacion.formato.formatoreactivo.notamin|floatformat:"0" }}" max="{{ asignacion.formato.formatoreactivo.notamax|floatformat:"0" }}" value="{{ asignacion.formato.formatoreactivo.notamin|floatformat:"0" }}" name="nota" class="validate[required,custom[onlyNumberSp],min[{{ asignacion.formato.formatoreactivo.notamin|floatformat:"0" }}],max[{{ asignacion.formato.formatoreactivo.notamax|floatformat:"0" }}]]">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid">
                                <div class="control-group cont-50" style="padding: 1%; min-height:45px; float: left;">
                                    <div class="control-label" style="width: 200px; text-align: right; line-height: 20px; padding-right: 10px;padding-top: 5px; float: left; text-transform: capitalize">
                                        <h5>Opción aleatoria:</h5>
                                    </div>
                                    <div class="controls cont-div-40">
                                        <input type="checkbox" id="aleat" name="aleatorio" checked>
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid" id="tbverdaderofalso" style="display: none;">
                               <div class="tree well" style="border-style: hidden; box-shadow: none; padding-bottom: 0px;" formwidth="100">
                                    <table class="table table-striped table-bordered " id="btvf" cellspacing="0" cellpadding="0">
                                        <thead>
                                            <tr><th style="text-align: center;" colspan="12"><h5>Opciones</h5></th></tr>
                                            <tr>
                                                <th style="text-align: center;"><h5>Opción</h5></th>
                                                <th style="text-align: center;"><h5>Valor (%)</h5></th>
                                                <th style="text-align: center;"><h5>Texto</h5></th>
                                            </tr>
                                        </thead>
                                        <tbody id="tbodyverdadero">
                                            <tr style="border: hidden;">
                                                <td style="width: 4%; border-right-style: hidden;">
                                                    <label for="checkbox_verdadero" class="labeltable">1 </label> <input id="checkbox_verdadero" class="checkbox_vf checkboxtable"  tipo="vf" valor="verdadero" type="checkbox">
                                                </td>
                                                <td style="width: 10%; border-left-style: hidden;">
                                                    <input type="number" id="vp_verdadero" min="1" max="100" class="validate[min[1],max[100],custom[onlyNumberSp]] valorvf" valor="verdadero" disabled>
                                                </td>
                                                <td style="width: 86%; border-left-style: hidden;">
                                                    <input type="text" formwidth="100" id="input_verdadero" texto="VERDADERO" value="VERDADERO" valor="verdadero" disabled/>
                                                </td>
                                            </tr>
                                            <tr style="border: hidden;">
                                                <td style="width: 4%; border-right-style: hidden;">
                                                    <label for="checkbox_falso" class="labeltable">2 </label> <input id="checkbox_falso" class="checkbox_vf checkboxtable"  tipo="vf" valor="falso" type="checkbox">
                                                </td>
                                                <td style="width: 10%; border-left-style: hidden;">
                                                    <input type="number" id="vp_falso" min="1" max="100" class="validate[min[1],max[100],custom[onlyNumberSp]] valorvf" valor="falso" disabled>
                                                </td>
                                                <td style="width: 71%; border-left-style: hidden;">
                                                    <input type="text" formwidth="100" id="input_falso" texto="FALSO" value="FALSO" valor="falso" disabled/>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="row-fluid" id="tbopcionmultiple" style="display: none;">
                                <div class="tree well" style="border-style: hidden; box-shadow: none; padding-bottom: 0px;" formwidth="100">
                                    <table class="table table-striped table-bordered " cellspacing="0" cellpadding="0">
                                        <thead>
                                            <tr><th style="text-align: center;" colspan="12"><h5>Opciones <button class="btn btn-mini btn-success pull-right add_filaom"><i class="fa fa-plus"></i> Agregar</button></h5></th></tr>
                                            <tr>
                                                <th style="text-align: center; width: 4%;"><h5>Opción</h5></th>
                                                <th style="text-align: center; width: 10%;"><h5>Valor (%)</h5></th>
                                                <th style="text-align: center; width: 56%;"><h5>Texto</h5></th>
                                                <th style="text-align: center; width: 20%;"><h5>Imagen</h5></th>
                                                <th style="text-align: center; width: 10%;"><h5>Ajuste</h5></th>
                                            </tr>
                                        </thead>
                                        <tbody id="tbodyopcionmultiple">
                                        {% for r in rango %}
                                            <tr class="trtable trom" idtr="{{ forloop.counter }}" style="{% if forloop.counter > asignacion.formato.formatoreactivo.opcionesmin %}display:none;{% endif %}" id="trom_{{ forloop.counter }}" obligatorio="{% if forloop.counter <= asignacion.formato.formatoreactivo.opcionesmin %}si{% else %}no{% endif %}" vali="{% if forloop.counter <= asignacion.formato.formatoreactivo.opcionesmin %}si{% else %}no{% endif %}">
                                                <td>
                                                    <label for="checkbox_om{{ forloop.counter  }}" class="labeltable" id="label_om{{ forloop.counter }}">{{ forloop.counter  }} </label> <input id="checkbox_om{{ forloop.counter  }}" class="checkboxtable checkbox_om"  tipo="om" valor="r" type="checkbox" idtr="{{ forloop.counter }}">
                                                </td>
                                                <td style="border-left-style: hidden; border-right-style: hidden;">
                                                    <input type="number" idtr="{{ forloop.counter }}" id="vp_om{{ forloop.counter }}" min="1" max="100" class="validate[min[1],max[100],custom[onlyNumberSp]] valorp" tipo="om" valor="" disabled>
                                                </td>
                                                <td style="border-left-style: hidden; border-right-style: hidden;">
                                                    <input type="text" style="text-transform: none;" formwidth="100" id="input_om{{ forloop.counter }}" texto="" class="opciontexto" idtr="{{ forloop.counter }}" />
                                                </td>
                                                <td style="border-left-style: hidden; border-right-style: hidden; text-align: center">
                                                    <input type="file" idtr="{{ forloop.counter }}" id="file_om{{ forloop.counter }}" name="file_om{{ forloop.counter }}" accept="image/*" tipo="om" class="fileom" valor="" tabindex="-1" style="position: absolute; clip: rect(0px, 0px, 0px, 0px);">
                                                </td>
                                                <td style="text-align: center;">
                                                    {% if forloop.counter > asignacion.formato.formatoreactivo.opcionesmin %}
                                                        <button class="btn btn-mini btn-danger" idtr="{{ forloop.counter }}" onclick="eliminar(this)" tipo="om" idfila="{{ forloop.counter }}"><i class="fa fa-remove"></i> Eliminar</button>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="row-fluid" id="tbemparejamiento" style="display: none;">
                                <div class="tree well" style="border-style: hidden; box-shadow: none; padding-bottom: 0px;" formwidth="100">
                                    <table class="table table-striped table-bordered " cellspacing="0" cellpadding="0">
                                        <thead>
                                            <tr><th style="text-align: center;" colspan="12"><h5>Opciones <button class="btn btn-mini btn-success pull-right add_filaem"><i class="fa fa-plus"></i> Agregar</button></h5></th></tr>
                                            <tr>
                                                <th style="text-align: center; width: 6%;"><h5>Opción</h5></th>
                                                <th style="text-align: center; width: 10%;"><h5>Valor (%)</h5></th>
                                                <th style="text-align: center; width: 37%;"><h5>Texto A</h5></th>
                                                <th style="text-align: center; width: 37%;"><h5>Texto B</h5></th>
                                                <th style="text-align: center; width: 10%;"><h5>Ajuste</h5></th>
                                            </tr>
                                        </thead>
                                        <tbody id="tbodyemparejamiento">
                                        {% for r in rango %}
                                            <tr class="trtable trem" idtr="{{ forloop.counter }}" style="{% if forloop.counter > asignacion.formato.formatoreactivo.opcionesmin %}display:none;{% endif %}" id="trem_{{ forloop.counter }}" obligatorio="{% if forloop.counter <= asignacion.formato.formatoreactivo.opcionesmin %}si{% else %}no{% endif %}" vali="{% if forloop.counter <= asignacion.formato.formatoreactivo.opcionesmin %}si{% else %}no{% endif %}">
                                                <td style="text-align: center">
                                                    <label class="labeltable" id="label_em{{ forloop.counter }}">{{ forloop.counter  }} </label>
                                                </td>
                                                <td style="border-left-style: hidden; border-right-style: hidden;">
                                                   <input type="number" idtr="{{ forloop.counter }}" id="vp_em{{ forloop.counter }}" min="1" max="100" class="validate[min[1],max[100],custom[onlyNumberSp]] valorem" tipo="em" valor="">
                                                </td>
                                                <td style="border-left-style: hidden; border-right-style: hidden;">
                                                    <input type="text" style="text-transform: none;" formwidth="100" id="input_ema{{ forloop.counter }}" texto="" class="opciontextoa" idtr="{{ forloop.counter }}" />
                                                </td>
                                                <td style="border-left-style: hidden; border-right-style: hidden;">
                                                    <input type="text" style="text-transform: none;" formwidth="100" id="input_emb{{ forloop.counter }}" texto="" class="opciontextob" idtr="{{ forloop.counter }}" />
                                                </td>
                                                <td style="text-align: center;">
                                                    {% if forloop.counter > asignacion.formato.formatoreactivo.opcionesmin %}
                                                        <button class="btn btn-mini btn-danger" idtr="{{ forloop.counter }}" onclick="eliminar(this)" tipo="em" idfila="{{ forloop.counter }}"><i class="fa fa-remove"></i> Eliminar</button>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="row-fluid" style="text-align: right">
                                <button class="btn btn-mini btn-warning" onclick="similitud();">Validar Reactivo</button>
                            </div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <input type='hidden' name='action' value='add_reactivodocente'/>
    <input type='hidden' name='id' value='{{ asignacion.id }}'/>
    <input type='hidden' name='valiopciones' id="valiopciones" value='0'/>
    <input type='hidden' name='validetalles' id="validetalles" value='0'/>
{% endblock %}
{% block formback %}/doc_configuracioncomplexivo?action=adm_reactivo{% endblock %}
{% block buttonname %}Siguiente{% endblock %}
{% block cancelname %} Salir {% endblock %}